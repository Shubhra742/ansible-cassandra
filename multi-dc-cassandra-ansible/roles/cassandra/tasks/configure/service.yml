---
- name: Enable Cassandra service
  systemd:
    name: cassandra
    enabled: yes
    daemon_reload: yes
  become: yes

- name: Start Cassandra service
  systemd:
    name: cassandra
    state: started
  become: yes

- name: Wait for Cassandra to be ready
  wait_for:
    port: 9042
    delay: 10
    timeout: 300
  when: not ansible_check_mode

- name: Check Cassandra status
  shell: nodetool status
  register: nodetool_status
  changed_when: false
  failed_when: false
  become: yes
  become_user: cassandra

- name: Display cluster status
  debug:
    var: nodetool_status.stdout_lines
  when: nodetool_status.stdout_lines is defined
